<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Our Little Festival World üéÑ</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Indie+Flower&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #ffcadf, #f3d9ff);
      min-height: 100vh;
      overflow-x: hidden;
      color: #4a2c3a;
      transition: background 0.8s, color 0.8s;
    }

    body.night {
      background: linear-gradient(135deg, #1f1235, #3b1d5a);
      color: #f6eaff;
    }

    header { text-align: center; padding: 70px 20px 30px; position: relative; z-index: 2; }

    .tree { position: fixed; bottom: -20px; right: -20px; font-size: 200px; opacity: 0.18; cursor: pointer; z-index: 1; }

    .countdown { margin: 30px auto 10px; background: rgba(255,255,255,0.75); padding: 14px 26px; border-radius: 24px; display: inline-block; font-weight: 500; }
    body.night .countdown { background: rgba(0,0,0,0.35); }

    .controls { display: flex; justify-content: center; gap: 14px; margin-top: 10px; flex-wrap: wrap; }
    .btn { background: #fff; border-radius: 22px; padding: 8px 18px; cursor: pointer; font-size: 0.85rem; box-shadow: 0 6px 18px rgba(0,0,0,0.15); user-select: none; transition: transform 0.2s; }
    .btn:hover { transform: scale(1.05); }
    body.night .btn { background: #2a1746; color: #fff; }

    .gifts { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; padding: 40px; max-width: 900px; margin: auto; position: relative; z-index: 2; }

    .gift { background: linear-gradient(135deg, #ff9ecf, #d5b6ff); border-radius: 22px; padding: 40px 20px; text-align: center; cursor: pointer; box-shadow: 0 12px 28px rgba(0,0,0,0.18); transition: transform 0.3s ease; }
    .gift:hover { transform: translateY(-6px) scale(1.03); }
    .locked { opacity: 0.6; cursor: not-allowed; }

    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.55); display: none; align-items: center; justify-content: center; z-index: 10; }

    .note { background: #fffaf3; padding: 32px; border-radius: 14px; max-width: 420px; font-family: 'Indie Flower', cursive; font-size: 1.25rem; line-height: 1.6; box-shadow: 0 18px 45px rgba(0,0,0,0.35); color: #4a2c3a; position: relative; z-index: 10; }
    body.night .note { background: #2b1745; color: #f6eaff; }

    .close { cursor: pointer; margin-bottom: 10px; }

    .float-up, .fall-down { position: fixed; pointer-events: auto; cursor: pointer; z-index: 3; }
    .float-up { bottom: -10vh; animation: floatUp linear infinite; }
    .fall-down { top: -10vh; animation: fallDown linear infinite; }

    @keyframes floatUp { to { transform: translateY(-120vh); } }
    @keyframes fallDown { to { transform: translateY(120vh); } }

    /* Message bubble */
    .emoji-bubble {
      position: fixed;
      background: rgba(255, 255, 255, 0.95);
      padding: 10px 14px;
      border-radius: 16px;
      font-size: 0.9rem;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      max-width: 220px;
      text-align: center;
      z-index: 20;
      animation: bubblePop 2.5s ease forwards;
    }

    body.night .emoji-bubble { background: rgba(40,20,70,0.95); color: #fff; }

    @keyframes bubblePop {
      0% { transform: scale(0.6); opacity: 0; }
      10% { transform: scale(1); opacity: 1; }
      80% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-10px); }
    }

    @keyframes heartBurst {
      from { transform: translate(-50%, -50%) scale(0.2); opacity: 1; }
      to { transform: translate(var(--x), var(--y)) scale(1); opacity: 0; }
    }
  </style>
</head>
<body>

  <div class="tree" id="tree">üéÑ</div>

  <header>
    <h1>Our Little Festival World üéÑ</h1>
    <p id="subtitle">A tiny pink world full of love, lights & you üíï</p>
    <div class="countdown" id="countdown"></div>
    <div class="controls">
      <div class="btn" id="musicBtn">üéµ Play music</div>
      <div class="btn" id="modeBtn">üåû / üåô</div>
    </div>
  </header>

  <section class="gifts">
    <div class="gift" data-note="0">üéÅ Why I Love You</div>
    <div class="gift" data-note="1">üéÅ Our Best Moments</div>
    <div class="gift" data-note="2">üéÅ A Surprise Message</div>
    <div class="gift locked" id="lockedGift">üîí Christmas Letter<br><small id="lockTimer"></small></div>
    <div class="gift locked" id="lockedPoem">üîí Christmas Poem<br><small id="poemTimer"></small></div>
  </section>

  <div class="overlay" id="overlay">
    <div class="note">
      <div class="close" id="closeNote">‚úï close</div>
      <div id="noteText"></div>
    </div>
  </div>

  <audio id="bgMusic" preload="auto" loop src="sounds/bg-music.mp3"></audio>
  <audio id="paperSound" preload="auto" src="sounds/paper.mp3"></audio>

  <script>
    // BASIC NOTES
    const notes = [
      "I love you because you turn even ordinary days into something warm, safe, and beautiful.",
      "Our laughs, our late talks, our silly moments ‚Äî I carry them all with me, always.",
      "No matter where life takes us, I choose you. Merry almost-Christmas, my love üéÑ‚ù§Ô∏è"
    ];

    // CHRISTMAS CONTENT
    const christmasLetter = `Merry Christmas, Pauline üéÑ‚ù§Ô∏è\n\nThis is a message made only for you.\nEvery light, every snowflake, every heartbeat\non this page exists because of how much I love you.\n\nI choose you ‚Äî always üíñ`;

    const christmasPoem = `(Write your poem here)\n\nLine by line,\nfrom my heart to yours üíï`;

    const oneLiners = [
      "I love you so much baby",
      "I miss you so much baby",
      "You are so amazing love",
      "You are so pretty baby",
      "Always keep smiling love",
      "A big Huggie from thousands miles away",
      "You are so adorable",
      "Merry Christmas!",
      "Happy New Year!",
      "I love you so so so much baby!"
    ];

    const dayEmojis = ['‚ù§Ô∏è','üéà','üéÜ','üíñ','‚ú®','üéÅ','üå∏'];
    const nightEmojis = ['‚ùÑÔ∏è','üéÅ','üíñ','üå®','‚òÉÔ∏è','‚õÑÔ∏è','üéÖüèº'];

    // ELEMENTS
    const overlay = document.getElementById('overlay');
    const noteText = document.getElementById('noteText');
    const paperSound = document.getElementById('paperSound');
    const music = document.getElementById('bgMusic');
    const countdown = document.getElementById('countdown');
    const poemTimer = document.getElementById('poemTimer');
    const lockTimer = document.getElementById('lockTimer');
    const subtitle = document.getElementById('subtitle');

    // NOTE HANDLING
    function openNote(text, withHearts){
      noteText.innerText = text;
      overlay.style.display = 'flex';
      paperSound.currentTime = 0;
      paperSound.play().catch(()=>{});
      if (withHearts) startHeartBurst();
    }

    document.getElementById('closeNote').onclick = () => overlay.style.display = 'none';
    document.querySelectorAll('.gift[data-note]').forEach(g => {
      g.onclick = () => openNote(notes[+g.dataset.note], false);
    });

    // TREE
    document.getElementById('tree').onclick = () => {
      const nick = prompt('üß∏ What does he call you?');
      if (nick) alert(`üéÑ ${nick}, you are deeply loved ‚ù§Ô∏è`);
    };

    // MUSIC
    let playing = false;
    document.getElementById('musicBtn').onclick = async () => {
      music.volume = 0.3;
      try {
        if (!playing) await music.play(); else music.pause();
        playing = !playing;
      } catch {
        alert('Tap once anywhere, then press Play üéµ');
      }
    };

    // FLOATING EMOJIS
    function clearFloating(){ document.querySelectorAll('.float-up,.fall-down').forEach(e=>e.remove()); }

    function spawnEmojis(type){
      clearFloating();
      const emojis = type === 'night' ? nightEmojis : dayEmojis;
      const cls = type === 'night' ? 'fall-down' : 'float-up';

      for (let i=0;i<30;i++){
        const e = document.createElement('div');
        e.className = cls;
        e.innerText = emojis[Math.floor(Math.random()*emojis.length)];
        e.style.left = Math.random()*100 + 'vw';
        e.style.fontSize = 18 + Math.random()*20 + 'px';
        e.style.animationDuration = 6 + Math.random()*8 + 's';

        const showMessage = (ev) => {
          ev.preventDefault();
          ev.stopPropagation();

          const bubble = document.createElement('div');
          bubble.className = 'emoji-bubble';
          bubble.innerText = oneLiners[Math.floor(Math.random()*oneLiners.length)];

          const rect = e.getBoundingClientRect();
          bubble.style.left = rect.left + rect.width / 2 + 'px';
          bubble.style.top = rect.top - 10 + 'px';
          bubble.style.transform = 'translateX(-50%)';

          document.body.appendChild(bubble);
          setTimeout(() => bubble.remove(), 2500);
        };

        e.addEventListener('click', showMessage);
        e.addEventListener('touchstart', showMessage, { passive: false });

        document.body.appendChild(e);
      }
    }

    // MODE TOGGLE
    document.getElementById('modeBtn').onclick = () => {
      document.body.classList.toggle('night');
      const night = document.body.classList.contains('night');
      subtitle.innerText = night
        ? 'A cozy night full of stars, love & us ‚ú®'
        : 'A tiny pink world full of love, lights & you üíï';
      spawnEmojis(night ? 'night' : 'day');
    };

    spawnEmojis('day');

    // HEART BURST
    function startHeartBurst(){
      const note = document.querySelector('.note');
      const rect = note.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;

      for (let i = 0; i < 120; i++){
        const h = document.createElement('div');
        h.innerText = 'üíñ';
        h.style.position = 'fixed';
        h.style.left = cx + 'px';
        h.style.top = cy + 'px';
        h.style.fontSize = 16 + Math.random() * 26 + 'px';
        h.style.pointerEvents = 'none';
        h.style.zIndex = 9;
        const angle = Math.random() * Math.PI * 2;
        const dist = 200 + Math.random() * 300;
        h.style.setProperty('--x', Math.cos(angle) * dist + 'px');
        h.style.setProperty('--y', Math.sin(angle) * dist + 'px');
        h.style.animation = 'heartBurst 1.8s ease-out forwards';
        document.body.appendChild(h);
        setTimeout(()=>h.remove(), 2000);
      }
    }

    // CHRISTMAS TIMER
    const now = new Date();
    //const christmas = new Date(now.getFullYear(), 11, 25, 0, 0, 0);
    // Test Date
    const christmas = new Date(Date.now() + 5000); // unlocks in 5 seconds
    const lockedGift = document.getElementById('lockedGift');
    const lockedPoem = document.getElementById('lockedPoem');

    function unlockChristmasLetter(){
      const name = prompt('üéÄ It‚Äôs Christmas üéÑ \n Type your name EXACTLY (Case sensitive)');
      if (name !== 'Pauline') return alert('‚ùå That‚Äôs not correct. \n Please enter the name EXACTLY üíï');
      openNote(christmasLetter, true);
    }

    function unlockPoem(){
      const name = prompt('üéÄ It‚Äôs Christmas üéÑ \n Type your name EXACTLY (Case sensitive)');
      if (name !== 'Pauline') return alert('‚ùå That‚Äôs not correct. \n Please enter the name EXACTLY üíï');
      openNote(christmasPoem, true);
    }

    setInterval(() => {
      const diff = christmas - new Date();
      if (diff > 0){
        const d = Math.floor(diff/86400000);
        const h = Math.floor(diff/3600000%24);
        const m = Math.floor(diff/60000%60);
        const s = Math.floor(diff/1000%60);
        countdown.innerText = `${d}d ${h}h ${m}m ${s}s until Christmas üéÑ`;
        lockTimer.innerText = poemTimer.innerText = `Unlocks in ${d}d ${h}h ${m}m`;
      } else {
        countdown.innerText = 'Merry Christmas üéÖ‚ù§Ô∏è';
        lockTimer.innerText = poemTimer.innerText = 'Unlocked!';
        lockedGift.classList.remove('locked');
        lockedPoem.classList.remove('locked');
        lockedGift.onclick = unlockChristmasLetter;
        lockedPoem.onclick = unlockPoem;
      }
    }, 1000);
  </script>
</body>
</html>
